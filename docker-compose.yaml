services:
  sysbank-multi:
    build: .
    image: sysbank:qt4-multi-hd
    container_name: sysbank_multi
    ports:
      - "8080:8080"
      - "5900-5950:5900-5950"
      - "6080-6130:6080-6130"
    environment:
      - RESOLUTION=1920x1080x24
      - QT_X11_NO_MITSHM=1
      - QT_GRAPHICSSYSTEM=native
      - LIBGL_ALWAYS_SOFTWARE=1
      - GALLIUM_DRIVER=llvmpipe
      - LP_NUM_THREADS=4
      - MESA_GL_VERSION_OVERRIDE=3.3
      - MESA_GLSL_VERSION_OVERRIDE=330
    volumes:
      - sysbank_data:/app/data
      - sysbank_instances:/app/instances
    restart: unless-stopped
    shm_size: '4gb'
    mem_limit: 8g
    cpus: 4

volumes:
  sysbank_data:
  sysbank_instances: